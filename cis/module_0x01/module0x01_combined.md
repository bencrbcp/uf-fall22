# MODULE 0x010 LECTURE 0x040 - Pentesting Ethics

## Perception of pentesters

"borderline illegal, evil, legal criminals, etc."

To avoid these perceptions, SySS suggests 10 concepts:
1) Independence (from client; aka don't be the tester for the security which you set up yourself). Also, don't test clients who you sell to.
2) Prohibition on commission fees
3) Care (for customer... let them know risks, negative outcomes, threats, interruption of services)
4) Professionalism & QA
5) Contractual adherance
6) Impartiality, neutrality, and transparency
7) Conflicts of interest (should be avoided and reported)
8) Strict obedience of law
9) Respect for human beings
10) Correct Attribution


## PHRASE PART 3:
```
Phrase part 3

YYed/Hx2vbhKG49FkAiP/GoVkIR8MX6hUlZiaPAuIOcbT4f4MKhWSzI7zQ2iFAyj+N2tMJ6KekxzESnzXnIuoBUxKNq9FohyANsnMjo+nvUutLzIjjnfV3dlBu1GBEofT6giITgEGcsuQf8rDezDCBncy1w8Uhqlq7j4hkrJd2eboAc2KkEwYFQQ8wall45wMYjikIA7LvMjNTyL6DoTiVbPjMUbX/dtWkO6obIrPAj5u9wnGV7qyKnG+5L3F2Bsrv/Ft+CZR93sTw0gbQtAbdKhRiQANwZoWKTH/4h8aTuoUOoy21hU2FA53pa9nAmnmTyyycYxF5cmGrcWVYOvITu6StnQlKcf92fgOYihe3urbxj+Md9T6Ytxe+DUORowu24B7F8ko5rZ5G1Ud9Yc//9ZqK+JZ1bQ8Y0Bq1gqif5zBUxUszuDBOQZMFyPoD9CCuRpJsRq5vEaXnsrFVA7Q+i3BHWkYOvCfOmSemaePnrqggh24aF4KUFtF2P6wwScj7ox1U8MFHRS4FLdntwjv9itDbX5c1f6hHxqa61058dwk67mgxJIdgAlYXJ1uVLIU0ueurCXOEIqow2aSTbntFUkiBsDelIxKO8Hyyvfot/KRoXE2AkPputkKhGuhBcikz4HWg3Zdk8aL7x6gzmENIx/
```





# MODULE 0x010 LECTURE 0x050 - Penetration Test Report


## Pentest report structure
1. Execute summary -- Background, overall Security posture, Risk ranking/profile, General findings, Recommendation summary, Strategic roadmap
2. Technical report -- Intro, Info gathering, Vulnerability assessment, Exploitaiton/vulnerability confirmation, Post-exploitaiton, Risk/exposure
3. Conclusion -- Recap all elements of the report, Support growth of client's security posture, Give support and guidance to enable progress in security program.

## CVSS scores

Common Vulnerability Scoring System.

* [CVSS calulator](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwi_kq3llff5AhVaSDABHakaA-oQFnoECAQQAQ&url=https%3A%2F%2Fwww.first.org%2Fcvss%2Fcalculator%2F3.0&usg=AOvVaw3Z3sVPrD9_NCfqnv_gj53e)


## Sample reports

* Hard to find online (who would want to disclose their vulns online)
    - OSCP has samples, but they're more focused on the attack narrative than client needs
* References to NIST SP 800-115
    - Upon completion of analysis, a report should be generated that identifies system, network, and organizatoinal vulns + recommended mitigations.


## Template (LaTeX)

* Can be found in the class directory on my laptop, or on Wilson's website


## PHRASE PART 4
```
Phrase part 4

hEdbWVAEeEWDTOu7D/SGcOyDSb1O1XrpYtYexOhEpXzV727h9SMKdYT85UqUeRoD2RGItWjQ3wNDhS3NJkn6/NPTFEAm46hBvbS1FJR9zUB+Q4+kVmv+smTzpxETXo7gRV5+KG2caIea+oRWkBnbvqJLLfss/DDqBotHdpA5abgQjxBQqdGven9mO1IrbCiNZbUF6xntKOzfULCYyFwAi2CLj89BwU51ryvOQiqsX9bvb5Zc+7YVU9DZdChuDsw8fFX0Iujt4ErJZAM8ZPHXuGGY1xRbFGzG/FBIkBxlaARyZYxAp7nFLYYesBAs1c1HkFrpUigS53qgbLanXaOLv6CEi8OtQinFqE+zcPiY6JjxUhcT7P84XbMwEGeyPKKz1boUrCWKmUPx4eJzjXhDGybK3fkKO4pqYYkMIbfoCCa8EbwWWnmXzEj29+xoS0C1PXJkKPLsKyqaNehpcE265zZtk55almfIZdwPRDb6kYVEq5gRQ33kn2C+1K5Ms6+BnVzhlOKV1eXaQ9RBPnC7SEUY7okXXq+ZQtsONs5bhcZZAIFr1AYCo4sJ5bL0+YvmlhOHCc7hBCiLqP1W16Ysnbm/W8v6ttJl0B4Hl/CPOPwJxlGy12H9XqvNiDLrdjZiJex8MQ5guT8gRMQ7QjUp5rJz
```





# MODULE 0x010 LECTURE 0x060 - US Cybercrime laws

## U.S. Code titles concerning cybercrime

- Title 6 (Domestic security)
- Title 15 (Commerce and trade)
- Title 17 (Copyrights)
- Title 18 (Federal crimes and criminal procedure)
- Title 21 (Food and drugs)
- Title 28 (Judiciary and judicial procedure)
- Title 47 (Telegraphs, telephones, radiotelegraphs)

* Cybersecurity Enhancement Act of 2002 (CSEA)
    - People realized... you can kill somebody with cybercrime
    - Amends the __Patriot Act__ which weakens requirements for a company to give their customers' electronic records to the government if they believe it threatens national security

* Internet fraud and Intellectual property theft are some of the most relevant cybercrime law types for pentesters


## Laws of most interest

Title 18 section 1362: Communication lines, stations, or systems
- Prohibits malicious injury of US gov's computer/communication stuff

Title 18 section 2510 et seq: Interception of wire, oral, or electronic comms
- Unauthorized interception is prohibited
- Allows service providers to intercept comms. in ways that are "necessary incident to the rendition of" service

Title 18 section 2701 eq set: Unlawful access to stored communications
- Illegal to obtain, alter, or prevent "authorized access to a wire or electronic comm. while it is in electrical storage" without exceeding authorization


## Florida State Law

Florida Computer Crimes Act
- Defines many terms: access, computer, network, etc.
- Does not define _authorization_
- 815.06 says that willfull, knowing, unauthorized access alone is illegal

* Credit card usage
    - Don't use random credit card numbers -- use approved test credit card numbers (find online)


## Recent law changes

* 2018 Federal legislation established Cybersecurity and Infrastructure Security Agency in the Department of Homeland Security
* Recent, increased interest in election security


## PHRASE PART 5
```
Phrase part 5

wTpO1V3GtuhimIcU/0rRAUNy4eVSxuTYc813Un5lFewYUZN2XHFqNRbaH4StziXKk2Hm+DGI3I0sULMcfGac1xCfOsyuxaxSj/cO9Z67PNPjC462elUFJB0Df5b3dTQ6XYWirVW98MXUAhnXztoDBf4eKWJjs/pIg3Cc0fPXGBHifosGEIXN0k48hPFTon3kEoqyJHNVQH2aZ9NGle71/0Bf0IFc8L+yRTuu/STkQ8JODm4EFJXN6ymyDt8UzEQzpK90En5xE/rbNgTSUi1e7pGELDa7MArQO3j+gz95M6h5jpdMzsi2rHry002H7+xfVHQgQMCxq6ISXhrz7RhZxYxKZ3MFqrQ6+kExosv9CfCIvmB+4FjNRHBHdRJSsR049B9XmoZ7Je7pXanuN6dH8jI4exu34Ht5suzZGRVUDXNdNmxWF1RTH/gzrNcmOOadYobAgGYY9V/UXa2DDnv4W4DwYcVA5YWm8ckixZawuNWNJedUI3VZTtnlGmS1LV8e2YJR/+teHKq/IgYMVOsIUL4VKiTfD+dp8Jz/aoO+7e6XcPQuF+STG0E1RErM7/gsGsci3wOg1hx5ZXG7LUTlnnQiJpclFuRQAXxP/ue0aM42SfaQct9arVUwgcdkYS1wwcWqNkWcUdkb9mFvTugUIjEm
```




# MODULE 0x010 LECTURE 0x070 - International Cybercrime Laws

## Canadian cybercrime laws

Criminal code of Canada, section 184:
- Intercepting private comms. using a device

Criminal code of Canada, section 342.1:
- Forbids fraudulently or without right, obtaining services, intercepting comms. on a computer, trafficking in passwords

Criminal code of Canada, section 402.2 and 403:
- Information / identity theft

Computer Misuse Act of 1990 (UK):
- Unauthorized access to computer material

German Criminal Code (GCC) section 303a:
- Forbids unlawful earsure, suppression, rendering useless, or altering data

German Criminal Code (GCC) section 303b:
- Interfering with data processing operations to commit an offense under 303a, or to damage and destroy processing system

German Criminal Code (GCC) section 202a: Espionage

German Criminal Code (GCC) section 202a: Phishing

German Criminal Code (GCC) section 202a: Acts Preparatory to Espionage (outlaws producing, selling, or acquiring passwords or password finding tools... intent matters!)

Concil of Europe Convention 185 on Cybercrime (Australia): Requires carriers to preserve data communications

Australian Cybercrime Act of 2001
- Division 477: Outlaws unauthorized access/modification of data/electronic comms. with intent to commit crime
- Divsion 478: Outlaws unauthorized access to data protected by access control or producing programs and data to commit the offense

Japanese law no. 128 of 1999:
- Illegal to conduct unauthorized computer access
- Illegal to evade access restrictions
- Cannot provide person's authentication to anyone unless you are admin or at admin's request
- Not more than 1-year sentence and 500,000 Yen
- These lax laws may be changing soon

E.U. Convention of Cybercrime:
- Treaty 185: Demands more access to stored data

E.U. GDPR (General Data Protection Regulation) of 2018:
- Gives individuals in EU control over their personal data
- Disclose data collection
- Places requirements and restrictions on processors of PII


## QUIZ ACCESS CODE:
Tom Devil - Larkin Poe





# MODULE 0x010 LECTURE 0x080 - VMs, Kali Linux, Etc.

A lot of things I already know, so they will be summarized:

- VMs: An instance of an actual machine, where a host is used to exhibit the same behavior as the target virtual machine.
- Kali: Distribution of Linux prepared by Offensive Security
- Built-in vs non-built-in commands: Built in commands are tasks that the shell carries out itself, rather than interpreting the command and requesting to run another program, e.g. `cd`

* NDG Lab for exercises:
    - [Link](https://ndg.cise.ufl.edu/)
    - Kali login is kali:kali (CHANGE THE PASSWORD AFTER LOGGING INTO A MACHINE)
    - Usernames and passwords for NDG Kali instances are in Ex010

* What's up with this Plunder server?
    - We are the newest interns at pr0b3.com
    - Perform your pentests using a Netlab Kali instance
    - Every time you start an instance, it is started from a fixed snapshot...
    - ...Any work you do is erased on logout, so __store any information (like keys!!!)__ somewhere else, e.g. on a `prob3.com` server. Just not on Kali instance. Prob3 server

* Plunder
    - Login to `plunder.pr0b3.com` from Netlab Kali instance to store stuff.
    - Login name on plunder is the same as NDG login name (gatorlink email address with underscores instead of dots)
    - You can find plunder password by logging into plunder as guest:guest
    - After logging in as guest, run `decrypt_account_list.py` to find your password


* __IMPORTANT HINT__
    - The passwords are encrypted using the exact method used to encrypt keys
    - Thus, we can use `decrypt_account_list.py` as a model for a key decrypter...


## PHRASE PART 6
```
Phrase part 6

CQinZDjnukZdi6O3OtiNVWifRbXG6YO/pzNZjun4ht/Uz0GO+/569iv8rSgWuSzeVI56/K1WRlOg3WLQs89n7aJiAr9VDJv0Vap+gZB9OSNvKin2AttRrk6vPcLhs8nRdr7s54o2eR+txspmTyNJ6DMCAr/9V9AjQB0RvY09e4CS1WqET3iCma59+YNg6Coulx7JRdN0BDrzCIyqrDg0OS226VF4YswLD2MZv0myZE5ZfvzCAVJUXAHbPKa75Ef/CXG1TRyjJB/YHtMRWGbUI7cBxgV973W7TbfwtLx/yGAXRbLXo8CLzdKqdbqmGOFFV8SvuarQSAjRnZ/Eb8qbwG1DAKVIA50CKloJyybNqSGNxdiK71D+yKh5t4ZGz/iWMaFLxOJxQeccNvV5cZxeXzMZid+MpDKJugQ2sToDjKqiVCPkCOuVkMIg94ya8BvaoYk9q5G6DPssQin1jD03OE1zL3T+q8wbWn4ifOnAyeN8J5S3VVgg18t/pUjXce79gs76lytvCCTaPr2l8IZhkOj7AM4NkcvZ7a/ftwAAa/tiAAYTgkgpuzjBRXDNBRNTta33k1xuSNfxpqXIH1hDZEWTNMbrQdUkDY4jmhRCQEXz8e1zaTLpoR+O/1cSoYnm8q1F6HZDQxSgy4+bQ5Un5IKI
```





# MODULE 0x010 LECTURE Ax000 - Key Facts About Keys

## What?

* In most exercises, there will be keys that can be found
    - sometimes as a result of carrying out some activity

* These keys are base64-encoded 16-byte sequences
    - The 16-byte sequences form a long crypt-text that can be decrypted
    - If you find all/enough of them you can decrypt entire sequence to find a passphrase for 4 points leeway credit on final exam
    - __If you provide the wrong passphrase,__ then you lose 2 points, so be sure if you input one

* E.g.
    - `KEY010:VGhpcyBpc24ndCBhIGtleQ==` (this is not a real key btw)


## What is AES?

* Advanced Encryption Standard
    - Based on cipher (Rijndael) developed by Vincent Rijmen and Joan Daemen
    - Based on a substitution-permutation network

* Prof Wilson's AES choices
    - Key size: 16 bytes = 128 bits
    - Cipher mode: CBC
    - Initialization vector (IV): Same size as key; `b'\n\xfdH\x92\x17\x05\xce\xe7\x84\xd0d\x06X#P+'`
    - Encrypt and decrypt with python3 AES class from the Crypto.Cipher module from pycryptodome (install with pip3)

* Cipher modes
    - ECB (Electronic Cobe Book): It sucks
    - CBC (Cipher Block Chaining): OK, not that good.
    - Galois Counter Mode (GCM): Probably the best bang for your buck in terms of security and performance


## ECB

* In this mode, each block is independently encrypted/decrypted
    - So if you have the key, you can recover the plaintextof ANY block independently

## CBC

* In this mode, an initialization vector (IV) is xor'd with the plaintext _before encrypting_
    - To decrypt the first block, you use the key to transform the ciphertext, and you xor the result of that with the IV
    - To decrypt subsequent blocks, you use the ciphertext of the previous block as the IV for the next block
    - i.e. If you are missing a block, you can decrypt neither that block nor the block that follows it


## Angecryption

* In addition to being the AES key, the encryption key is also the ciphertext associated with the inital key
    - Message starts with decrypted initial key
    - Method of providing the key was suggested by Ange Albertini's Angecryption method
    - He didn't know much about encryption when faced with this challenge

* Important takeaway from Ange's talk:
    - You only need to know enough to get the problem solved
    - Too much information in our modern world... __don't try to understand everything. Just important things.__


__WHAT I GATHERED:__

- The phrases are likely the different ciphertext blocks of the overall message
- We have the IV
- We just need the keys to start decrypting them (apparently there is one in Ax000?)
    - The passwords are encrypted using the exact method used to encrypt keys
    - Thus, we can use `decrypt_account_list.py` as a model for a key decrypter...
- Maybe `decrypt_account_list.py` has the key???
- Alternatively, look through the Ax000 presentation again because supposedly the key is there? (no clue where)
